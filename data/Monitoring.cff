include "DQM/SiStripCommon/data/Log4cplus.cff"
replace MessageLogger.log4cplus = { untracked string threshold = "DEBUG" }

// geometry and magnetic field
include "Geometry/CMSCommonData/data/cmsSimIdealGeometryXML.cfi"
include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

// DQM
include "DQM/SiStripCommon/data/DaqMonitorROOTBackEnd.cfi"

// InputSource
include "IORawData/SiStripInputSources/data/DaqSource.cfi"

// Cabling
include "OnlineDB/SiStripESSources/data/FedCablingFromConfigDb.cfi"
replace FedCablingFromConfigDb.ConfDb = ""
replace FedCablingFromConfigDb.Partition = ""
es_module conn = SiStripConnectivity {}

// RawToDigi, ZeroSuppressor and SiStripClusterizer
include "EventFilter/SiStripRawToDigi/data/SiStripDigis.cfi"
include "RecoLocalTracker/SiStripZeroSuppression/data/SiStripZeroSuppression.cfi"
include "RecoLocalTracker/SiStripClusterizer/data/SiStripClusterizer_RealData.cfi"

// --------------------------------------------------
// Monitoring modules: digi, clusters, pedestals (?)
// --------------------------------------------------

include "DQM/SiStripMonitorDigi/data/SiStripMonitorDigi_SimData.cfi"
replace SiStripMonitorDigi.SelectAllDetectors = true

include "DQM/SiStripMonitorCluster/data/SiStripMonitorCluster.cfi"
replace SiStripMonitorCluster.SelectAllDetectors = true
replace SiStripMonitorCluster.OutputMEsInRootFile = false
replace SiStripMonitorCluster.UseCalibDataFromDB = true

module PedsMon = SiStripMonitorPedestals {
    string DigiProducer="SiStripDigis"
    bool OutputMEsInRootFile = false
    string OutPutFileName="WeShouldNotSeeThisFile"
    untracked bool UseFedKey = true
    bool OutputMEsInRootFile = true
    PSet PedestalsPSet = {
	string CalculatorAlgorithm = "TT6"
	int32 NumCMstripsInGroup =128
	int32 MaskCalculationFlag =1
	double MaskNoiseCut = 6.
	double MaskDeadCut = 0.7
	double MaskTruncationCut = 0.05
	double CutToAvoidSignal =3.
	int32 NumberOfEventsForInit = 200
	int32 NumberOfEventsForIteration = 100
    }
}

path p = { 
    SiStripDigis, 
    siStripZeroSuppression, 
    siStripClusters, 
    PedsMon, 
    SiStripMonitorDigi,
    SiStripMonitorCluster
}
